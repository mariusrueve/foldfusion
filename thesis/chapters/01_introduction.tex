\Chapter{Introduction}
\label{chap:introduction}

Proteins are the primary effectors of cellular function, and understanding their three-dimensional (3D) structures is essential for mechanistic insight, target identification, and rational design in biotechnology and drug discovery. For decades, experimental structure determination by X-ray crystallography, nuclear magnetic resonance (NMR) spectroscopy, and cryo-electron microscopy (cryo-EM) has provided atomic-level information, but at significant cost and with notable coverage gaps. Recent breakthroughs in machine learning, most prominently \textit{AlphaFold} and \textit{RoseTTAFold}, have transformed the landscape by enabling accurate in~silico structure prediction directly from amino-acid sequences, dramatically increasing the number of available models across many proteomes \cite{jumperHighlyAccurateProtein2021, baekAccuratePredictionProtein2021,tunyasuvunakoolHighlyAccurateProtein2021}. These advances have catalyzed a shift from ``structure scarcity'' to a new phase in which the central challenges concern structural context, functional annotation, and downstream usability of predicted models.

In this thesis, a distinction is made between \emph{experimental structural models} (determined by X-ray, NMR, or cryo-EM and deposited in the PDB \cite{burleyRCSBProteinData2019}) and \emph{predicted models} (e.g., AlphaFold, RoseTTAFold). Experimental structures frequently capture proteins in a \emph{holo} state, i.e., with bound small molecules such as metal ions, cofactors, or ligands; by contrast, predicted models are provided as \emph{apo} proteins without non-polymer entities by design. The term \emph{ligands} is used to refer broadly to small molecules in binding sites, including organic cofactors (e.g., heme, FAD, NAD(P)H) and mono- or polyatomic ions (e.g., Zn$^{2+}$, Mg$^{2+}$). Because many proteins require such moieties to stabilize their fold or to realize catalysis, the absence of these entities in predicted structures can obscure function, binding-site chemistry, and downstream computability. Moreover, predicted models include per-residue confidence scores (e.g., pLDDT in AlphaFold) that correlate with local reliability and often flag flexible or poorly constrained regions, reinforcing the need to reason about context before analysis \cite{jumperHighlyAccurateProtein2021, burleyRCSBProteinData2019, hekkelmanAlphaFillEnrichingAlphaFold2023}.

\section{Motivation}
Predicted single-chain protein models typically represent the polypeptide backbone and side chains under canonical residue chemistry. However, many proteins only adopt their native fold or functional state in the presence of small molecules: metal ions that stabilize architecture, organic cofactors that mediate catalysis, and physiologically relevant ligands such as ATP, heme, or NAD(P)H. In predicted models, these moieties are absent by design, which complicates functional interpretation, binding-site analysis, and computational follow-ups such as molecular docking or molecular dynamics. Moreover, the conformational state of a predicted model is often not annotated, and flexible regions may be modelled with lower confidence, further widening the gap between prediction and experimental use in structure-guided workflows.

As a concrete example, protein kinases and many ATPases require Mg$^{2+}$-ATP in the active site to position catalytic residues and neutralize charge; in an apo predicted model, the nucleotide pocket may appear collapsed or incorrectly polarized, hampering binding-site recognition and leading to unrealistic docking poses. Similarly, heme enzymes without the porphyrin cofactor or zinc-finger domains without Zn$^{2+}$ can appear destabilized or ambiguous with respect to their functional geometry. Restoring these entities from homologous experimental structures often reveals the correct local architecture and plausible interaction networks, enabling more faithful functional hypotheses and more realistic computational experiments \cite{hekkelmanAlphaFillEnrichingAlphaFold2023}.

\section{Problem Statement}
A central question is how to systematically enrich predicted protein structures with plausible, biochemically sensible small molecules and ions to make them more useful for functional reasoning and downstream computation, without requiring de novo quantum mechanics or extensive experimental input for each target. The central idea explored in this thesis is to exploit the wealth of biophysical knowledge already contained in experimentally determined structures deposited in the Protein Data Bank (PDB) \cite{burleyRCSBProteinData2019} by transferring (``transplanting'') ligands and cofactors from suitable homologues into corresponding predicted models.

\section{Prior Work and Opportunity}
A closely related line of work demonstrates that large-scale ligand transplantation from experimentally solved homologous structures into AlphaFold models is both feasible and useful. For example, the \textit{AlphaFill} resource applies sequence and structure similarity to transplant common ligands, cofactors, and metal ions from curated experimental models, validating quality with metrics such as local RMSD and a transplant-clash score. At scale, AlphaFill reported over twelve million transplants across nearly one million AlphaFold models, exposing binding sites, restoring essential cofactors (e.g., heme, Zn$^{2+}$, Mg$^{2+}$), and enabling hypothesis generation about function \cite{hekkelmanAlphaFillEnrichingAlphaFold2023}. While this demonstrates the promise of homology-driven enrichment, there remains a practical need for open, lightweight, and extensible pipelines that researchers can adapt to bespoke datasets, integrate into modern data/ML workflows, and evaluate end-to-end on specific biological questions.

This opportunity is addressed with a binding-site-guided, modular pipeline that differs from prior resources in several ways. First, candidate donor structures are prioritized via binding-site detection to focus alignment on functionally relevant pockets (using \emph{DoGSite3} \cite{graefBindingSiteDetection2023}). Second, site-centric structural alignment is performed to position donor sites relative to the predicted target (via \emph{SIENA} \cite{bietzSIENAEfficientCompilation2016}). Third, transplanted ligands are optionally refined with a simple pose optimization/scoring step (\emph{JAMDAScorer} \cite{flachsenbergConsistentSchemeGradientBased2020}) to reduce clashes and improve geometry. Finally, each placement is annotated with quality indicators, \emph{Local RMSD} in the ligand environment and a \emph{Transplant Clash Score (TCS)}, to support downstream triage and decision-making. These choices emphasize transparency, configurability, and ease of integration with scripting- and batch-oriented research workflows.

\section{Thesis Aim}
This thesis presents a proof-of-concept pipeline that automates ligand and cofactor transplantation from the PDB into AlphaFold structures to produce \emph{context-enriched} models suitable for exploratory analysis and computational follow-up.\footnote{A public code repository accompanies this work; see Chapter~\ref{chap:methods} for implementation details and reproducibility considerations.} At a high level, the pipeline (i) identifies homologous donor structures with relevant non-polymer entities, (ii) performs global and local structural alignments to position candidate ligands, (iii) applies simple but effective filters to prioritize biochemically sensible placements, and (iv) emits enriched models and metadata for quality control and downstream use.

Throughout, \emph{Local RMSD} (a measure of structural agreement in the protein environment around the ligand) and a \emph{Transplant Clash Score} (a measure of steric overlap between ligand and protein) are reported as lightweight indicators of placement quality; full definitions appear in Chapter~\ref{chap:methods}. The pipeline is evaluated on a representative set of UniProt targets assembled for this study, and outcomes are summarized in Chapter~\ref{chap:results}.

\section{Contributions}
The main contributions of this thesis are:
\begin{enumerate}
    \item \textbf{A modular, open pipeline for ligand transplantation.} The pipeline implements an end-to-end workflow that ingests predicted structures, retrieves homologous experimental entries, and transplants non-polymer entities (ligands, cofactors, metal ions) with provenance tracking and reproducible configuration.
    \item \textbf{Quality indicators and metadata for downstream trust.} The pipeline annotates each transplant with alignment measures and simple clash checks, enabling users to stratify placements by confidence and decide when refinement is warranted.
    \item \textbf{Empirical evaluation on representative targets.} The evaluation illustrates use cases where enrichment adds value for functional interpretation (e.g., revealing cofactor requirements or likely substrate preferences) and for computation (e.g., seeding docking with realistic binding-site chemistry).%
    \item \textbf{Engineering for reproducibility and integration.} The codebase is designed for batch execution, scripted analysis, and integration with common structural bioinformatics tools, easing adoption in research settings.
\end{enumerate}

\section{Research Questions}
The following questions guide this thesis:
\begin{itemize}
    \item \textbf{RQ1:} To what extent can homolog-based ligand transplantation reliably restore biochemically plausible small-molecule context in predicted structures?
    \item \textbf{RQ2:} Which alignment and filtering criteria most influence transplant quality, and how should they be configured in practice?
    \item \textbf{RQ3:} How does structural enrichment affect downstream tasks such as docking preparation, site annotation, or hypothesis generation about protein function?
\end{itemize}

\section{Scope and Limitations}
The pipeline focuses on non-polymer ligands and metal ions commonly represented in the PDB. It does not perform full flexible-receptor docking or quantum refinement, and it does not attempt to model post-translational modifications or glycans. As with any homology-based approach, transplant reliability depends on the availability and quality of structurally similar donors, as well as on the conformational compatibility between donor and acceptor. Enriched models should be treated as \emph{qualitative} hypotheses that can guide experiments or more detailed simulations, rather than as final, quantitatively precise holo structures \cite{hekkelmanAlphaFillEnrichingAlphaFold2023}.

\section{Thesis Structure}
Chapter~\ref{chap:methods} details the pipeline design and implementation. Chapter~\ref{chap:results} reports evaluation on diverse targets and discusses quality indicators and failure modes. Chapter~\ref{chap:conclusion} concludes and outlines avenues for future work, including refinement protocols and multi-state/complex modelling.
